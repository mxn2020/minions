---
title: Lifecycle
description: How minions are created, updated, deleted, and restored.
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

## Creation

When you create a minion:

1. A UUID v4 `id` is generated
2. `createdAt` and `updatedAt` are set to the current time
3. Fields are validated against the MinionType schema
4. Default values from the schema are applied
5. `status` defaults to `"active"` if not specified

<Tabs>
  <TabItem label="TypeScript">
  ```typescript
  import { createMinion } from 'minions-sdk';

  const { minion, validation } = createMinion({
    title: 'My Note',
    fields: { content: 'Hello world' },
  }, noteType);

  if (!validation.valid) {
    console.error(validation.errors);
  }
  ```
  </TabItem>
  <TabItem label="Python">
  ```python
  from minions import create_minion
  from minions.schemas import note_type

  minion, validation = create_minion(
      {"title": "My Note", "fields": {"content": "Hello world"}},
      note_type,
  )

  if not validation.valid:
      print(validation.errors)
  ```
  </TabItem>
</Tabs>

## Update

Updates merge new field values with existing ones. `updatedAt` is refreshed.

<Tabs>
  <TabItem label="TypeScript">
  ```typescript
  import { updateMinion } from 'minions-sdk';

  const { minion: updated } = updateMinion(existing, {
    fields: { content: 'Updated content' },
  }, noteType);
  ```
  </TabItem>
  <TabItem label="Python">
  ```python
  from minions import update_minion

  updated, validation = update_minion(
      existing,
      {"fields": {"content": "Updated content"}},
      note_type,
  )
  ```
  </TabItem>
</Tabs>

## Soft Delete

Soft delete marks a minion as deleted without removing it. Relations are preserved.

<Tabs>
  <TabItem label="TypeScript">
  ```typescript
  import { softDelete } from 'minions-sdk';

  const deleted = softDelete(minion, 'user-123');
  // deleted.deletedAt is set
  // deleted.deletedBy is 'user-123'
  ```
  </TabItem>
  <TabItem label="Python">
  ```python
  from minions import soft_delete

  deleted = soft_delete(minion, "user-123")
  # deleted.deleted_at is set
  # deleted.deleted_by is "user-123"
  ```
  </TabItem>
</Tabs>

## Restore

Restoring clears the deletion markers.

<Tabs>
  <TabItem label="TypeScript">
  ```typescript
  import { restoreMinion } from 'minions-sdk';

  const restored = restoreMinion(deleted);
  // restored.deletedAt is null
  ```
  </TabItem>
  <TabItem label="Python">
  ```python
  from minions import restore_minion

  restored = restore_minion(deleted)
  # restored.deleted_at is None
  ```
  </TabItem>
</Tabs>

## Hard Delete

Hard delete permanently removes the minion. All relations involving it must also be removed.

<Tabs>
  <TabItem label="TypeScript">
  ```typescript
  import { hardDelete } from 'minions-sdk';

  hardDelete(minion, graph);        // clean up relations
  myMinionStore.delete(minion.id);  // then remove from your storage
  ```
  </TabItem>
  <TabItem label="Python">
  ```python
  from minions import hard_delete

  hard_delete(minion, graph)           # clean up relations
  my_minion_store.delete(minion.id)    # then remove from your storage
  ```
  </TabItem>
</Tabs>
